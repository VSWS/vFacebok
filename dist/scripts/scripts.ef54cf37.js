"use strict";var app=angular.module("ifacebookApp",["ngAnimate","ui.router","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","btford.socket-io","facebook"]);app.config(["$stateProvider","$urlRouterProvider","$mdIconProvider","FacebookProvider",function(a,b,c,d){b.otherwise("/home"),a.state("home",{url:"/",templateUrl:"views/home.html"}).state("campaign",{url:"/campaign",templateUrl:"views/campaign.html",controller:"CampaignCtrl"}).state("graphSearch",{url:"/graphsearch",templateUrl:"views/grapSearch.html",controller:"GraphSearchCtrl"}).state("fanPage",{url:"/fanPage",templateUrl:"views/fanPage.html",controller:"FanPageCtrl"}).state("group",{url:"/group",templateUrl:"views/group.html",controller:"GroupCtrl"}).state("website",{url:"/website",templateUrl:"views/website.html",controller:"WebsiteCtrl"}).state("friend",{url:"/friend",templateUrl:"views/friend.html",controller:"FriendCtrl"}).state("friendFollow",{url:"/friendFollow",templateUrl:"views/friendFollow.html",controller:"FriendFollowCtrl"}).state("event",{url:"/event",templateUrl:"views/event.html",controller:"EventCtrl"}).state("map",{url:"/map",templateUrl:"views/map.html",controller:"MapCtrl"}).state("settings",{url:"/settings",templateUrl:"views/settings.html",controller:"SettingsCtrl"}).state("test",{url:"/test",templateUrl:"views/test.html",controller:"TestCtrl"}),c.icon("menu","images/svg/ic_menu_24px.svg").icon("chiendich","images/svg/ic_assignment_24px.svg").icon("thietlap","images/svg/ic_settings_applications_24px.svg").icon("thoat","images/svg/ic_keyboard_return_24px.svg").icon("graph","images/svg/ic_trending_up_24px.svg").icon("fanpage","images/svg/ic_find_in_page_24px.svg").icon("group","images/svg/ic_group_work_24px.svg").icon("website","images/svg/ic_devices_24px.svg").icon("friend","images/svg/ic_account_child_24px.svg").icon("friendFollow","images/svg/ic_group_add_24px.svg").icon("event","images/svg/ic_event_available_24px.svg").icon("map","images/svg/ic_map_24px.svg").icon("user","images/svg/ic_account_circle_24px.svg"),d.init("1583470488573133")}]).run(["$mdSidenav","$rootScope","$log","$http","$server",function(a,b,c,d,e){b.user={id:"55226b73529523560a73f96d",username:"tung",token:"abcde"},b.toggleLeft=function(){a("leftMenu").toggle().then(function(){c.debug("toggle left is done")})}}]),app.controller("LeftMenuCtrl",["$scope","$timeout","$mdSidenav","$log","$state",function(a,b,c,d,e){a.settings=[{name:"Chiến dịch",icon:"chiendich",link:"campaign"},{name:"Graph Search",icon:"graph",link:"graphSearch"},{name:"FanPage",icon:"fanpage",link:"fanPage"},{name:"Nhóm",icon:"group",link:"group"},{name:"Website",icon:"website",link:"website"},{name:"Bạn bè",icon:"friend",link:"friend"},{name:"Bạn bè Follow",icon:"friendFollow",link:"friendFollow"},{name:"Sự kiện",icon:"event",link:"event"},{name:"Vị trí",icon:"map",link:"map"},{name:"Thiết lập",icon:"thietlap",link:"settings"},{name:"Thoát",icon:"thoat",link:"logout"}],a.goState=function(a){e.go(a)},a.close=function(){c("leftMenu").close().then(function(){d.debug("close LEFT is done")})}}]),angular.module("ifacebookApp").service("$fb",["$rootScope","$http",function(a,b){var c="1583470488573133";return{init:function(){return function(a,b,c){console.log("Facebook: Init SDK ");var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")},query:function(a){window.fbAsyncInit=function(){FB.init({appId:c,xfbml:!0,version:"v2.3"}),console.log("Run FB"),FB.getLoginStatus(function(a){"connected"===a.status?console.log("Logged in."):(console.log("show login"),FB.login())}),a(FB)}}}}]),angular.module("ifacebookApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("TestCtrl",["$scope","$http",function(a,b){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("CampaignCtrl",["$scope","$rootScope","$mdDialog","$server",function(a,b,c,d){function e(){console.log("Running Test Get Campaign:"),d.getCampains().success(function(b){a.campaigns=b}).error(function(b){a.status="Unable to load data:"+b})}b.titleHeader="Chiến dịch",a.campaigns=[],e(),a.removeCampaign=function(b){console.log("ID remove:",b);var c=a.campaigns[b];d.removeCampaign(c._id).success(function(c){console.log("Remove success:",c),a.campaigns.splice(b,1)}).error(function(a){console.log("Unable to load data",a)})},a.createCampaign=function(){var c={name:a.nameCampaign,idUser:b.user.id};console.log("Campaigns:",a.campaigns),a.campaigns.push(c),d.createCampaign(c),a.nameCampaign=""}}]),angular.module("ifacebookApp").controller("GraphSearchCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Graph Search";var c=[{title:"Chiến dịch",content:"Lựa chọn Chiến dịch bạn sẽ thực hiện lấy uID Facebook"},{title:"Khởi tạo",content:"Nhập đường link "},{title:"Phân tích",content:"You can bind the selected tab via the selected attribute on the md-tabs element."},{title:"Xử lý",content:"If you set the selected tab binding to -1, it will leave no tab selected."},{title:"Kết quả",content:"If you remove a tab, it will try to select a new one."}],d=null,e=null;a.tabs=c,a.selectedIndex=0,a.$watch("selectedIndex",function(a,b){e=d,d=c[a],b&&b!=a&&$log.debug("Goodbye "+e.title+"!"),a&&$log.debug("Hello "+d.title+"!")})}]),angular.module("ifacebookApp").controller("FanPageCtrl",["$scope","$rootScope","$fb","$server","$timeout","$mdDialog",function(a,b,c,d,e,f){function g(c){d.getPostsByPage(c,b.server).success(function(b){console.log("Data Autoload:",b),b&&(a.feed=b,setTimeout(function(){g(c)},3e3))}).error(function(a){console.log(a)})}console.log("Controller: FanPage Loading"),b.titleHeader="FanPage",a.tabs={selectedIndex:0,tab2Locked:!1,tab3Locked:!1,tab4Locked:!1,tab5Locked:!0},a.nextTab=function(){a.tabs.selectedIndex=Math.min(a.tabs.selectedIndex+1,2)},a.loadCampains=function(){return a.campaigns=[],a.selectedCampaign={},e(function(){d.getCampains(b.server).success(function(b){a.campaigns=b,console.log("Campaigns: ",a.campaigns)}).error(function(b){a.status="Unable to load data:"+b})},500)},a.cacheIdCampaign=function(b){a.idCampaign=b},a.pages=[],a.totalUIDPage=0,a.loadPages=function(){d.getPages().success(function(b){b.forEach(function(b){d.countPosts(b._id).success(function(c){a.pages.push({data:b,count:c}),a.totalUIDPage=a.totalUIDPage+c[0].hasUID,console.log("List Page:",a.pages)})})}).error(function(b){a.status=b,console.log(b)})},a.initPage=function(c){console.log("Page Node",c),d.initPage(c,b.server).success(function(b){console.log("Data init Page:",b),a.infoPage=b}).error(function(b){console.log("err:",b),a.status("Unable loading from server:",b)})},a.alert="",a.createPage=function(){var c=a.infoPage;c.idCampaign=a.idCampaign,console.log("Campaign selected: ",a.idCampaign,c),d.createPage(c,b.server).success(function(b){console.log("Data",b._id),a.getFeed(a.infoPage.username,b._id),g(b._id),a.nextTab(),b.message&&(a.status=b.message)}).error(function(b){console.log("Error",b),a.status=b})},a.feed=[],a.showFeed=function(a,b){console.log("Show Feed:",a,b),g(b)};var h;a.getFeed=function(b,c){console.log("Node:",b,"- idPage:",c),d.getFeeds(b,c).success(function(d){console.log("Data FEED:",d),a.feed=d.data,b==h&&g(c)}).error(function(a){console.log("Server error:",a)})},a.updateFeed=function(b,c){console.log("Node:",b,"- idPage:",c),d.updateFeed(b,c).success(function(b){console.log("Data Feed Update:",b),a.feed=b.data}).error(function(a){console.log("Server error:",a)})},a.tokens=[],a.GetUid=function(a,b,c){console.log("Getting data ...",a,b,c),d.getUid(a,b,c).success(function(a){console.log(a)}).error(function(a){console.log(a)})},a.setLock=function(b){var c=a.feed[b];d.setLock(c.idPost).success(function(a){console.log("set lock idPost",c.idPost,a)}).error(function(a){console.log("error set lock idPost",c.idPost,a)})},a.unLock=function(b){var c=a.feed[b];d.unLock(c.idPost).success(function(a){console.log("set lock idPost",c.idPost,a)}).error(function(a){console.log("error set lock idPost",c.idPost,a)})},a.LoadMorePost=function(b){d.loadmorePost(b).success(function(b){a.feed.paging.next=b.paging.next,b.data.forEach(function(b){a.feed.data.push(b)})})},a.loadUFB=function(){return a.UFBs=[],a.selectedUFB=[],e(function(){d.getAllUFB().success(function(b){a.UFBs=b,console.log("All UFB: ",a.UFBs),console.log("Selected UFB",a.selectedUFB)}).error(function(b){a.status="Unable to load data:"+b})},500)}}]),angular.module("ifacebookApp").controller("GroupCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Graph Search",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("WebsiteCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Website",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("FriendCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Friend",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("FriendFollowCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Friend Follow",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("EventCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Event",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("MapCtrl",["$scope","$rootScope",function(a,b){b.titleHeader="Map",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").controller("SettingsCtrl",["$scope","$rootScope","$server","Facebook","$state",function(a,b,c,d,e){function f(b){c.getUFB(b).success(function(b){console.log("Datas FB User:",b),a.uFbs=b.datas}).error(function(a){console.log("Error:",a)})}b.titleHeader="Thiết lập";var g;a.tokenFB=null,a.uFbs=[],a.addUserFb=function(){g={user:a.uFb.user,pass:a.uFb.pass},a.uFbs.push({user_facebook:g.user,pass_facebook:g.pass,status:"Chưa kích hoạt"}),console.log(a.uFbs),a.uFb.user="",a.uFb.pass=""};var h=b.user.id;f(h),a.active=function(e){console.log("Active Account facebook",a.uFbs[e].user_facebook),d.getLoginStatus(function(f){"connected"===f.status?(d.logout(function(f){console.log("Logout:",f),d.login(function(d){console.log("login:",d);var f=d.authResponse.accessToken;console.log("Token:",f),c.setLongToken({short_token:f,userFb:a.uFbs[e].user_facebook,passFb:a.uFbs[e].pass_facebook,idUser:b.user.id}).success(function(a){console.log("Data Success",a)}).error(function(a){console.log("error save token",a)})})}),a.loggedIn=!0):(d.login(function(a){console.log("login:",a)}),a.loggedIn=!1)})},a.isUsed=function(b){var d=a.uFbs[b];console.log("User FB",d),c.setUserFB(d._id).success(function(a){console.log("Set user facebook OK",a)}).error(function(a){console.log("Set user facebook Error:",a)})},a.removeFB=function(b){var d=a.uFbs[b];console.log(d),c.removeFB(d.user_facebook).success(function(c){a.uFbs.splice(b,1),console.log("Remove success user",c)}).error(function(a){console.log("error remove user",a)})},a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("ifacebookApp").factory("CampaignFactory",["$http",function(a){var b=42;return{createCampaign:function(a){},datas:[{name:"Thời trang Nam",value:"thoi-trang-nam"},{name:"Thời Trang Nữ",value:"thoi-trang-nu"},{name:"Đào tạo công nghệ",value:"dao-tao-cong-nghe"},{name:"Bất động sản",value:"bat-dong-san"},{name:"Đồng hồ",value:"dong-ho"},{name:"Iphone",value:"iphone"}],someMethod:function(){return b}}}]),angular.module("ifacebookApp").service("$server",["$http","$mdDialog","$rootScope",function(a,b,c){var d="http://104.131.63.188:3000";c.server=d;var e={};return e.checkServer=function(){return a.get(d).success(function(a){console.log("Server OK:",a)}).error(function(a){console.log("Server Error:",a),b.show(b.alert().title("Thông báo").content("Không thể kết nối tới Server: "+d+". Vui lòng liên hệ Support!").ok("Got it!"))})},e.setLongToken=function(b){return this.checkServer(),a.post(d+"/setLongToken",b)},e.removeLongToken=function(b){return this.checkServer(),a.post(d+"/removeLongToken",b)},e.getLongToken=function(b){return this.checkServer(),a.get(d+"/getLongToken?idUser="+b)},e.getAllUFB=function(){return this.checkServer(),a.get(d+"/getAllFB")},e.getUFB=function(b){return this.checkServer(),a.get(d+"/getUFB?idUser="+b)},e.setUserFB=function(b){return this.checkServer(),a.get(d+"/setUserFB?id="+b)},e.removeFB=function(b){return this.checkServer(),a.get(d+"/removeFB?user_facebook="+b)},e.getCampains=function(){return this.checkServer(),a.get(d+"/campaign")},e.getCampaign=function(b){return this.checkServer(),a.get(d+"/campaign?id="+b)},e.createCampaign=function(b){return this.checkServer(),a.post(d+"/campaign",b)},e.updateCampaign=function(b){return this.checkServer(),a.put(d+"/campaign",b)},e.removeCampaign=function(b){return this.checkServer(),a.get(d+"/campaign/remove?id="+b)},e.getPages=function(){return this.checkServer(),a.get(d+"/page")},e.getPage=function(b){return this.checkServer(),a.get(d+"/page?id="+b)},e.initPage=function(b){return this.checkServer(),a.get(d+"/page/initPage?node="+b)},e.createPage=function(b){return this.checkServer(),a.post(d+"/page",b)},e.updatePage=function(b){return this.checkServer(),a.put(d+"/page",b)},e.removePage=function(b){return this.checkServer(),a.post(d+"/page/remove?id="+b)},e.getFeeds=function(b,c){return this.checkServer(),a.get(d+"/post/getFeed?node="+b+"&idPage="+c)},e.updateFeed=function(b,c){return this.checkServer(),a.get(d+"/post/updateFeed?node="+b+"&idPage="+c)},e.getPosts=function(){return this.checkServer(),a.get(d+"/post")},e.getPostsByPage=function(b){return this.checkServer(),a.get(d+"/post/getPostsByPage?idPage="+b)},e.getPost=function(b){return this.checkServer(),a.get(d+"/post/"+b)},e.createPost=function(b){return this.checkServer(),a.post(d+"/post",b)},e.updatePost=function(b){return this.checkServer(),a.put(d+"/post",b)},e.removePost=function(b){return this.checkServer(),a.post(d+"/post/remove?id="+b)},e.setLock=function(b){return this.checkServer(),a.get(d+"/post/setLock?id="+b)},e.unLock=function(b){return this.checkServer(),a.get(d+"/post/unLock?id="+b)},e.countPosts=function(b){return a.get(d+"/post/countUidPage?id="+b)},e.getUid=function(b,c,e){return this.checkServer(),a.get(d+"/uid/saveuid/"+b+"/"+c+"/"+e)},e.loadmorePost=function(b){return a.post(d+"/post/morefeed",{paging:b})},e}]),angular.module("ifacebookApp").factory("socketFactory",function(){var a=42;return{someMethod:function(){return a}}});